sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
### Firms & Lobbying
### Sensitivity Analysis
rm(list=ls())
devtools::install_github("chadhazlett/sensemakr")
# Load packages
pacman::p_load(data.table, tidyverse, fixest, sensemakr)
# set working directory
if(Sys.info()["user"]=="fiona" ) {setwd("/Users/fiona/Dropbox/BBH/BBH1/")}
if(Sys.info()["user"]=="christianbaehr" ) {setwd("/Users/christianbaehr/Dropbox/BBH/BBH1/")}
if(Sys.info()["user"]=="vincentheddesheimer" ) {setwd("~/Dropbox (Princeton)/BBH/BBH1/")}
# load data
df <- fread("data/lobbying_df_wide__red_w_directionality.csv")
# Transform Variables -----------------------------------------------------
# dummy variable: climate issues
df <- df |>
mutate(CLI = ifelse(ENV == 1 |
CAW == 1 |
ENG == 1 |
FUE == 1,
1,0))
df$CLI_dollars <- apply(df[, c("amount_num_ENV", "amount_num_CAW", "amount_num_ENG", "amount_num_FUE")],
1, function(x) sum(x, na.rm=T) / 1000000)
# Control variables -------------------------------------------------------
#US dummy variable
df <- df |>
mutate(us_dummy = ifelse(hqcountrycode == "US",1,0))
#Total annual lobbying (total dollars)
df <- df |>
group_by(gvkey, year) |>
# mutate(total_lobby = n_distinct(report_uuid))
mutate(total_lobby = sum(c_across(grep("amount_num", names(df), value=T))))
df <- df |>
# group by unit (in our case: firm)
group_by(gvkey) |>
# arrange by year
arrange(year) |>
# for one year
mutate(#log_co2_l1 = lag(log_co2, 1),
total_lobby_l1 = lag(total_lobby, 1)) |>
#ungroup
ungroup()
df$industry <- df$bvd_sector
df <- df[which(df$industry!=""), ]
df$industry_year <- paste(df$industry, df$year)
sum(duplicated(df[, c("year", "report_quarter_code", "gvkey")]))
## continuous variables in regression models
df_cont_vars <- c("cc_expo_ew_y", "cc_expo_ew_q", "op_expo_ew_y", "rg_expo_ew_y", "ph_expo_ew_y",
"ebit", "at", "total_lobby")
## pull from main data
df_cont <- df[, df_cont_vars]
## rescale to standard normal
df_cont <- scale(df_cont)
## slot back into main df
df[, df_cont_vars] <- df_cont
# Transform variabls for regression
df <- df |>
mutate(
ebit_asset = ebit/at,
CLI_dollars = log(CLI_dollars +1)
)
# Run Models --------------------------------------------------------------
# m_occurence <- lm(CLI ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby + factor(year) + factor(industry) + factor(industry_year), df)
m_occurence <- feols(CLI ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# m_amount <- lm(CLI_dollars ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby + factor(year) + factor(industry) + factor(industry_year), df)
m_amount <- feols(CLI_dollars ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# runs sensemakr for sensitivity analysis
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots", width = 10, height = 8)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 10, height = 8)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 10, height = 5)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 7, height = 5)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 7, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 8, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 8, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots.pdf", width = 8.5, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
m_occurrence <- feols(CLI ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots_occurence.pdf", width = 8.5, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_occurence,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_occurence,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_occurence,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Amount ------------------------------------------------------------------
m_amount <- feols(CLI_dollars ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots_amount.pdf", width = 8.5, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_amount,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_amount,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_amount,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(150, 300)
)
)
title("Physical")
# Close the PDF device
dev.off()
# Amount ------------------------------------------------------------------
m_amount <- feols(CLI_dollars ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots_amount.pdf", width = 8.5, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_amount,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(100, 200)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_amount,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(100, 200)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_amount,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(100, 200)
)
)
title("Physical")
# Close the PDF device
dev.off()
m_amount <- feols(CLI_dollars ~ op_expo_ew_y + rg_expo_ew_y + ph_expo_ew_y + ebit + ebit_asset + us_dummy + total_lobby | year + industry + industry_year, df)
# Save the plots to a PDF file with specified dimensions
pdf("~/Dropbox (Princeton)/BBH/BBH1/results/Figures/sensitivity/sensitivity_plots_amount.pdf", width = 8.5, height = 3)
par(mfrow=c(1,3))
# First Plot
plot(
sensemakr(
m_amount,
treatment = "op_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(50, 100)
)
)
title("Opportunity")
# Second Plot
plot(
sensemakr(
m_amount,
treatment = "rg_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(50, 100)
)
)
title("Regulatory")
# Third Plot
plot(
sensemakr(
m_amount,
treatment = "ph_expo_ew_y",
benchmark_covariates = "ebit",
kd = c(50, 100)
)
)
title("Physical")
# Close the PDF device
dev.off()
